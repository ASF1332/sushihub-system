generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// --- Tabela de Insumos (Estoque) ---
model Insumo {
  id            Int     @id @default(autoincrement())
  nome          String
  categoria     String
  unidade       String  @default("un")
  estoque       Float   @default(0)
  estoqueMinimo Float   @default(0)
  
  produtos      FichaTecnica[]
}

// --- Tabela de Produtos (Cardápio) ---
model Produto {
  id        Int     @id @default(autoincrement())
  nome      String
  preco     Float
  categoria String
  
  fichaTecnica FichaTecnica[]
  itensPedido  ItemPedido[]
}

// --- Tabela Pivot (Ficha Técnica) ---
model FichaTecnica {
  id         Int     @id @default(autoincrement())
  produtoId  Int
  insumoId   Int
  quantidade Float   

  produto    Produto @relation(fields: [produtoId], references: [id])
  insumo     Insumo  @relation(fields: [insumoId], references: [id])
}

// --- Tabela de Pedidos ---
model Pedido {
  id        Int      @id @default(autoincrement())
  cliente   String
  telefone  String?
  canal     String   // iFood, WhatsApp, Local
  status    String   // Novo, Em Preparo, etc.
  valor     Float
  dataHora  DateTime @default(now())

  itens     ItemPedido[]
}

// --- Tabela de Itens do Pedido ---
model ItemPedido {
  id         Int     @id @default(autoincrement())
  pedidoId   Int
  produtoId  Int
  quantidade Int
  
  pedido     Pedido  @relation(fields: [pedidoId], references: [id])
  produto    Produto @relation(fields: [produtoId], references: [id])
}

// --- NOVA TABELA: CLIENTES ---
model Cliente {
  id          Int     @id @default(autoincrement())
  nome        String
  telefone    String  @unique
  cep         String?
  logradouro  String?
  numero      String?
  bairro      String?
  cidade      String?
  estado      String?
  complemento String?
}